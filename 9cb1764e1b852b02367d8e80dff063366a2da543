{
  "comments": [
    {
      "key": {
        "uuid": "5cee8935_e25b28bf",
        "filename": "java/README.txt",
        "patchSetId": 6
      },
      "lineNbr": 447,
      "author": {
        "id": 1001401
      },
      "writtenOn": "2014-03-21T02:21:46Z",
      "side": 1,
      "message": "From this jsr 133 FAQ (http://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html) I\u0027m not sure we can guarantee even the read-only consistency without some type of \"sync\" mechanism (volatile or synchronized or ...) used by both the readers and writers.\n\nAs I understand it, if Thread A updates a field that has no \"sync\" mechanism then Thread B accessing that field has no guarantee when it might see that new value. Thus if Thread A modifies a field but then Thread B does the serialization I don\u0027t think we can guarantee Thread B will serialize the value written by Thread A as Thread A never \"signaled\" any other thread that it modified the field.\n\nWe could add something like below:\n\n  public void MessageNano#sync() {\n     synchronized(LAZY_INIT_LOCK) {}\n  }\n\nAnd then suggest that if users want a strong guarantee of consistency that reader and writer threads need to call sync().",
      "revId": "9cb1764e1b852b02367d8e80dff063366a2da543",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1cf0910e_5da11bb8",
        "filename": "java/README.txt",
        "patchSetId": 6
      },
      "lineNbr": 447,
      "author": {
        "id": 1043228
      },
      "writtenOn": "2014-03-21T03:59:22Z",
      "side": 1,
      "message": "In order to satisfy the requirement that no writes take place at the same time as reads in a multi-threaded system, the user would need to have a locking mechanism in place, e.g. a ReadWriteLock, and therefore consistency is guaranteed.\n\nThe other possibility is that a thread makes a write, and then starts another thread(s) to do read-only operations. Also in this case consistency is guaranteed because of the happens-before relationship.",
      "parentUuid": "5cee8935_e25b28bf",
      "revId": "9cb1764e1b852b02367d8e80dff063366a2da543",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5cee8935_85c7c631",
        "filename": "java/README.txt",
        "patchSetId": 6
      },
      "lineNbr": 447,
      "author": {
        "id": 1001401
      },
      "writtenOn": "2014-03-21T06:20:38Z",
      "side": 1,
      "message": "So you\u0027re requiring explicit external synchronization, that works fine, but it doesn\u0027t say that to me. Do you mean to say something like:\n\n\"In other words, if a message is being modified the readers and writers of the message, plus the messages ancestors and its descendants must be accessed using an appropriate synchronization mechanism.\"",
      "parentUuid": "1cf0910e_5da11bb8",
      "revId": "9cb1764e1b852b02367d8e80dff063366a2da543",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1cf0910e_fdc90744",
        "filename": "java/README.txt",
        "patchSetId": 6
      },
      "lineNbr": 447,
      "author": {
        "id": 1043228
      },
      "writtenOn": "2014-03-21T15:28:52Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5cee8935_85c7c631",
      "revId": "9cb1764e1b852b02367d8e80dff063366a2da543",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}